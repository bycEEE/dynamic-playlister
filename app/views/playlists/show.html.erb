<center><div id="player"></div></center>
<script src="http://www.youtube.com/iframe_api"></script>

<script>
    /*
     * Put your video IDs in this array
     */
    var videoIDs = [
        'i_kF4zLNKio', <%= @songs.html_safe %>
    ];

    var player, currentVideoId = 0;

    function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
            height: '350',
            width: '425',
            events: {
                'onReady': onPlayerReady,
                'onStateChange': onPlayerStateChange
            }
        });
    }

    function onPlayerReady(event) {
        event.target.loadVideoById(videoIDs[currentVideoId]);
    }

    function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.ENDED) {
            currentVideoId++;
            if (currentVideoId < videoIDs.length) {
                player.loadVideoById(videoIDs[currentVideoId]);
            }
        }
    }
</script>
<center>
<%= form_tag do %>
  <%= submit_tag("skip", :id => "skip-song") %>
<% end %>
</center>

<div id="playlist" class="container col-xs-9 col-md-6 col-xs-offset-2 col-md-offset-2">
  <h1><%= @playlist.name %></h1>
  <table if="playlist-table">
    <% @playlist.requests.each do |request| %>
      <%= div_for request, class: "rowBox" do %>
          <div>
            <div class="voting" id="voting-<%= request.id%>">
              <h6 id="vote-count-<%= request.id%>"><%= request.vote_count%></h6>
              <a class="upvote" id="upvote-<%= request.id%>"> upvote </a>
              <a class="downvote" id="downvote-<%= request.id%>">downvote</a>
              <a class="delete" id="delete-<%=  request.id %>">delete</a>
            </div>
            <%= link_to "#{request.song.name}", request.song %>
          </div>
      <% end %>
    <% end %>
  </table>

  <h2>What we want:</h2>
  <%= render 'add_song_form' %>
</div>

<!-- CHAT FEATURE: -->
<%= render 'chat_box_and_form' %>