<div id="chat" class="container col-xs-6 col-md-4">

<%= link_to_if(@playlist.host == current_user, "Edit Playlist Information", { controller: "playlists", action: "edit" })%>

<p>
  <!-- using raw here. should probably have helper method to escape html -->
  Tags: <%= raw @playlist.tag_list.map { |tag| link_to tag, tag_path(tag) }.join(", ") %>
</p>

<div>
  <% if @playlist.subscribers.count > 0 %>
    <h3>Playlist subscribers:</h3>
    <% @playlist.subscribers.each do |subscriber| %>  
        <img src="<%= subscriber.profile_image %>" alt="<%= subscriber.name %>'s profile icon."> 
      </a> 
    <% end %>
  <% else %>
    <h3>This playlist has no subscribers.</h3>
  <% end %>
</div>


  <h1>Chat:</h1>
  <div id="message-div">
    <table id="message-table" class="table">
      <% @playlist.chat_messages.each do |message| %>
        <% if message.user_id == current_user.id %>
          <tr class="current_user_comment">
            <td><%= message.user.name %>: <%= message.content %></td>
          </tr>
        <% else %>
          <tr class="other_user_comment">
            <td><%= message.user.name %>: <%= message.content %></td>
          </tr>
        <% end %>
      <% end %>
    </table>
  </div>

  <%= form_for [@playlist, ChatMessage.new], :html => {:id => "chat-message-form"} do |f| %>
    <%= f.hidden_field :playlist_id, value: @playlist.id %>
    <%= f.hidden_field :user_id, value: current_user.id %>
    <%= f.text_field :content %>
    <%= f.submit "Send", :id => 'chat_send'%>
  <% end %>
</div>